  ## Import styles & scripts
  #template('conversationssetup.vm')
  ## Import vars
  #template('conversationsvars.vm')
  ## Import macros
  #template('conversationsmacros.vm')
  ## Count comments
  #set($topicAnswers = $xwiki.searchDocuments(', BaseObject obj where doc.parent = ? and doc.fullName = obj.name and obj.className = ? and doc.fullName != ? order by doc.date desc', 0, 0, [$doc.fullName, 'ConversationCode.AnswerClass', 'ConversationCode.AnswerTemplate']))
  #set($comments = $topicAnswers.size())
  #foreach($topicAnswer in $topicAnswers)
    #set($answerDoc = $xwiki.getDocument($topicAnswer))
    #set($answerComments = $answerDoc.getComments())
    #set($comments = $comments + $answerDoc.getComments().size())
  #end
  ## Display topic header
  <div id="conversation-topic" class="conversation-main">
    <div class="conversation-titlebar">
      <div class="conversation-inlineactions">                
        #if($xwiki.hasAccessLevel('edit', $xcontext.user, $doc.prefixedFullName))
          <span class="separator">|</span>
          <span class="commenttool commentedit"><a class="edit" href="$doc.getURL('edit')" title="$msg.get('conversations.topic.edit')">$msg.get('conversations.topic.edit')</a></span>
        #end
        #if("$!viewer" == 'conversationstopic')
          <span class="separator">|</span>
          <span class="conversation-ratings">
            <span class="conversation-like">
              <input type="hidden" name="documenttolike" value="$doc.fullName" />
              <img src="$escapetool.xml($xwiki.getDocument('ConversationCode.Styles').getAttachmentURL('conversation-like.png'))" alt="$escapetool.xml($msg.get('conversation.like.button'))"
                 #if($xwiki.ratings.getRating($doc, $xcontext.user) == $util.null)class="canVote" title="$msg.get('conversation.like.button.tooltip')"#else title="$msg.get('conversation.like.button.alreadyliked.tooltip')"#end />
            </span>
            #set($rating = $xwiki.ratings.getAverageRating($doc).nbVotes)
            <span class="conversation-score" title="$msg.get('conversation.like.score.tooltip', [$rating])">$!rating</span>
          </span>
        #end
        <span class="separator">|</span>
        <span class="conversation-count">$comments</span>
      </span>
    </div>
  </div>
  ## Display topic title and description
  <div id="document-title" class="conversation-title"><h1>$doc.displayTitle</h1></div>
  <div class="forum-description">$doc.display('description')</div>
  ## Display answer (conversation) add form
  #displayConversationAddForm()
  #displayAnswers()
  ## Enable WYSIWYG editors loading when adding comments
  #displayEditors()
